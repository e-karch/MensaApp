{
  "db_name": "PostgreSQL",
  "query": "\n            SELECT food_id \n            FROM food JOIN meal USING (food_id)\n            WHERE similarity(name, $1) >= $4\n            AND food_id IN (\n                SELECT food_id \n                FROM food_allergen FULL JOIN food USING (food_id)\n                GROUP BY food_id \n\t\t\t\tHAVING COALESCE(array_agg(allergen) FILTER (WHERE allergen IS NOT NULL), ARRAY[]::allergen[]) <@ $2::allergen[] \n\t\t\t\tAND COALESCE(array_agg(allergen) FILTER (WHERE allergen IS NOT NULL), ARRAY[]::allergen[]) @> $2::allergen[]\n            )\n            AND food_id IN (\n                SELECT food_id\n\t\t\t\tFROM food_additive FULL JOIN food USING (food_id)\n\t\t\t\tGROUP BY food_id \n\t\t\t\tHAVING COALESCE(array_agg(additive) FILTER (WHERE additive IS NOT NULL), ARRAY[]::additive[]) <@ $3::additive[] \n\t\t\t\tAND COALESCE(array_agg(additive) FILTER (WHERE additive IS NOT NULL), ARRAY[]::additive[]) @> $3::additive[]\n            )\n            ORDER BY similarity(name, $1) DESC\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "food_id",
        "type_info": "Uuid"
      }
    ],
    "parameters": {
      "Left": [
        "Text",
        {
          "Custom": {
            "name": "_allergen",
            "kind": {
              "Array": {
                "Custom": {
                  "name": "allergen",
                  "kind": {
                    "Enum": [
                      "CA",
                      "DI",
                      "EI",
                      "ER",
                      "FI",
                      "GE",
                      "HF",
                      "HA",
                      "KA",
                      "KR",
                      "LU",
                      "MA",
                      "ML",
                      "PA",
                      "PE",
                      "PI",
                      "QU",
                      "RO",
                      "SA",
                      "SE",
                      "SF",
                      "SN",
                      "SO",
                      "WA",
                      "WE",
                      "WT",
                      "LA",
                      "GL"
                    ]
                  }
                }
              }
            }
          }
        },
        {
          "Custom": {
            "name": "_additive",
            "kind": {
              "Array": {
                "Custom": {
                  "name": "additive",
                  "kind": {
                    "Enum": [
                      "COLORANT",
                      "PRESERVING_AGENTS",
                      "ANTIOXIDANT_AGENTS",
                      "FLAVOUR_ENHANCER",
                      "PHOSPHATE",
                      "SURFACE_WAXED",
                      "SULPHUR",
                      "ARTIFICALLY_BLACKENED_OLIVES",
                      "SWEETENER",
                      "LAXATIVE_IF_OVERUSED",
                      "PHENYLALANINE",
                      "ALCOHOL",
                      "PRESSED_MEAT",
                      "GLAZING_WITH_CACAO",
                      "PRESSED_FISH"
                    ]
                  }
                }
              }
            }
          }
        },
        "Float4"
      ]
    },
    "nullable": [
      false
    ]
  },
  "hash": "5a6dea0864e3c677166e860dfca85559ef149ddd36fbbbcf51938ec6a6fb6fcc"
}
